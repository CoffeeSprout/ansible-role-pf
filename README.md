coffeesprout.pf
==============

Sets up PF.
Be careful with any role that might cut you off from your server ;-)

See the "Role Variables" section for options and defaults. This role intentionally keeps it as simple as possible.

Requirements
------------

Tested on base FreeBSD 11.0+
Requires: https://github.com/dlundgren/ansible-freebsd-modules or the Ansible devs to finally push his work to master.

Role Variables
--------------

    pf_limit_states: 400000
  
sets the maximum number of entries in the memory pool used by state table entries (generated by pass rules which	do not specify no state)


    pf_ip_pub: "{{ ansible_default_ipv4.address }}"

The public IP
  
    pf_ext_if: "{{ ansible_default_ipv4.device }}"
  
Sets the external interface(s)

    pf_skip:  
    - lo0

Inteface(s) to skip

    pf_enable_gateway: False

Sets up a nat rule and enables gateway support in FreeBSD

    pf_tcp_pass_out:
    - 22
    - 80
    - 443

The TCP ports to allow out of the machine (for example 22 for SSH to other hosts, 80 to be able to curl, etc)

    pf_udp_pass:
    - 53
    - 67
    - 68
    - 123
 

The UDP ports to allow in both directions

    pf_rc_conf:
    - name: "pf\_enable"
      value: "YES"
    - name: "pf\_flags"
      value: ""
    - name: "pflog\_enable"
      value: "YES"
    - name: "pflog\_logfile"
      value: "/var/log/pflog"
    - name: "pflog\_flags"
      value: ""
    - name: "pf\_rules"
      value: "/etc/pf.conf"
    - name: "gateway\_enable"
      value: "{{ pf_enable_gateway | ternary('YES', 'NO') }}"
    - name: "ipv6\_gateway\_enable"
      value: "{{ pf_enable_gateway | ternary('YES', 'NO') }}"

The extra settings that will be added to /etc/rc.conf

Dependencies
------------

none

Example Playbook
----------------

Including an example of how to use your role (for instance, with variables passed in as parameters) is always nice for users too:

    - hosts: vpn-servers
      roles:
      - role: coffeesprout.pf
        pf_enable_gateway: True
        pf_tcp_pass_out:
        - 22
        - 80
        - 443
        pf_tcp_pass_in:
        - 22
        - 1194
        pf_udp_pass:
        - 53
        - 113
        - 1194



License
-------

BSD

Author Information
------------------

An optional section for the role authors to include contact information, or a website (HTML is not allowed).
